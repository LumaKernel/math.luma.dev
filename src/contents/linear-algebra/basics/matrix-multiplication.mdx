<Config
  title="行列同士の積の定義"
  published
/>


```math:def
\def\i{\ci{i}}
\def\iv{\ci{\text{\textbar}}}
\def\ih{\ci{\text{\textemdash}}}
\def\j{\cj{j}}
\def\jv{\cj{\text{\textbar}}}
\def\jh{\cj{\text{\textemdash}}}
```

## <Q w="mat-mult" k d />

<Q w="mat" />$\underset{n \times m}{A}$と$\underset{m \times l}{B}$の<Q w="mat-mult" />$A \cdot B$を<Q w="mat" />$\underset{n \times l}{C}$として定義する。ただし、

```math
  \underset{n \times m}{(a_{i,j})_{i,j}}
\cdot
  \underset{m \times l}{(b_{j,k})_{j,k}}
\defeq
  \underset{n \times l}{\left(\sum_{1 \leq j \leq m}{a_{i, j} \times b_{j, k}}\right)_{i, k}}
```

とする。

ところで、<Q w="mat"/>の<Q w="row"/>と<Q w="column"/>に関する定義は基本的には対照的で、どちらが横向きでもいいのだが、そうでない定義（片方で定義したものが特に意味を持つ定義）というのが今後登場する。この章にもそうした定義が登場する。その非対称性は、この<Q w="mat-mult" />の定義の、<Q w="row"/>と<Q w="column"/>の非対称性に由来する。

$A \cdot B$は省略して$AB$とも書く。

## <Q w="mat-mult" k />の計算方法

TODO

## <Q w="mat-mult" k />の意味

TODO

### <Q w="multi-variable" k/><Q w="system-of-lin-eq" k />を<Q w="mat-mult" k />で表す

```math
\begin{cases}
  3 x +  y + 2 z = 3 \\
   x + (-1) y + z = 4 \\
\end{cases}
```

を

```math
\begin{pmatrix}
  3 & 1 & 2 \\
  1 & -1 & 1 \\
\end{pmatrix}
\begin{pmatrix}
  x \\ y \\ z \\
\end{pmatrix} =
\begin{pmatrix}
  3 \\ 4 \\
\end{pmatrix}
```

と表すことができる。

より一般に、$n$変数、$m$個の<Q w="equation"/>が連立しているとき、係数を表す<Q w="mat"/>$\underset{n \times m}{A}$、変数を表す<Q w="vec"/>$\mathbf{x}=(x_0, x_1, \cdots, x_{n-1})$、そして定数部を表す<Q w="vec"/>$\mathbf{b}=(b_0, b_1, \cdots, b_{m-1})$を用いて、

```math
A\mathbf{x}=\mathbf{b}
```

と表せる。これを<Q w="system-of-lin-eq" d/>と呼ぶ。また、$\mathbf{b}=\mathbf{0}$であるとき、<Q w="system-of-lin-eq"/>は<Q w="homo" d/>であるといい、<Q w="homo-system"/>と呼ぶ。

## <Q w="mat-mult" k />の性質

<C w="mat-mult" template="%s. " start={1} />

### <C w="mat-mult"/><Q w="associativity" />: $(AB)C=A(BC)$

<Prove>
  TODO
</Prove>

### <C w="mat-mult"/><Q w="mat-add" />との<Q w="distributivity" />: $A(B+C)=AB+AC$

証明略。

### <C w="mat-mult"/><Q w="scaling" />との<Q w="associativity" />: $(kA)B=k(AB)$

証明略。

### <C w="mat-mult"/>$\t{(AB)}=\t{B}\t{A}$

<Prove>
  $X \coloneqq \LHS$とする。$\t{X}= AB$となる。

  ```math:trans
  \t{x}_{i,k}
  = \sum_{1 \leq j \leq m}{a_{i, j} \times b_{j, k}}
  ?\load{qk:mat-mult}
  ```

  上記の$i$と$k$を入れ替えることで<Q w="transpose" />となる。

  ```math:trans
  x_{i,k}
  = \sum_{1 \leq j \leq m}{a_{k, j} \times b_{j, i}}
  ```

  $Y\coloneqq\RHS$とする。

  ```math:trans
  y_{i,j}
  = \sum_{1 \leq j \leq m}{\t{b}_{i, j} \times \t{a}_{j, k}}
  ?\load{qk:mat-mult}
  = \sum_{1 \leq j \leq m}{b_{j, i} \times a_{k, j}}
  ?\load{qk:transpose}の定義より、それぞれの添字を入れ替える
  = \sum_{1 \leq j \leq m}{a_{k, j} \times b_{j, i}}
  ?\load{qk:field}の\load{qk:mult}に関する\load{qk:commutativity}
  ```

  以上より$\forall~i,j~[x_{i,j}=y_{i,j}]$であることがわかった。つまり、$X=Y$となる。
</Prove>

## <Q w="inv-mat" k d />

<Q w="mat" />$A$に対して、$AB=\idmat$かつ$BA=\idmat$となる<Q w="mat" />$B$を<Q w="inv-mat" />と呼ぶ。

注意: このような$A$は<Q w="square-matrix"/>しかありえないが、証明するまでは循環論法を避けるためにこれらの性質は使わない。

## <Q w="invertible-mat" k d/>

<Q w="invertible-mat"/>とは、<Q w="inv-mat"/>が存在する<Q w="mat"/>のことである。

## 定理: <Q w="invertible-mat"/>$A$の<Q w="inv-mat"/>は一意である

<Q w="invertible-mat"/>$A$の<Q w="inv-mat"/>を$A^{-1}$と書く。

<Prove>
$B$と$C$を<Q w="invertible-mat"/>$A$の<Q w="inv-mat"/>とする。

```math:trans
AB=I
>
CAB=C
$ \text{左から}C\text{を乗じた}
-
(CA)B=C
? \load{qk:mat-mult}の\load{qk:commutative}
-
IB=C
$ \load{qk:inv-mat}\text{の定義より}CA=I
-
B=C
? \load{qk:identity-matrix}の性質より
```
</Prove>

## <Q w="invertible-mat" k/>の性質

### <Q w="invertible-mat" k/>に$0$のみの<Q w="row"/>や<Q w="column"/>は含まれない。

$0$のみの<Q w="row"/>や<Q w="column"/>のことを<Q w="zero" d/><Q w="row"/>や<Q w="zero"/><Q w="column"/>と呼ぶことにする。

<Prove>
$AB=I$

[](#q-mat-mult-の計算方法)を見てもらうとわかるように、$A$の<Q w="row"/>$i$が$0$のみのなら、$I$の<Q w="row"/>$i$も$0$のみと言うことになるが、$I$には<Q w="zero"/><Q w="row"/>はないので矛盾。
$BA=I$に対して同様の議論を行うことで、<Q w="zero"/><Q w="column"/>も含まれない。
</Prove>

## <Q w="leading-entry" k d />

<Q w="leading-entry" />とは、<Q w="mat"/>内の<Q w="elem"/>であって、$0$を除いたもののうち、各<Q w="row"/>ごとに、最も左にある<Q w="elem"/>のこと。
各<Q w="row"/>ごとに、高々$1$個の<Q w="leading-entry"/>が存在する。

なお、この<Q w="leading-entry" />が<Q w="row"/>に関して定義されていることがまさに、上記で述べた<Q w="row"/>と<Q w="column"/>の非対称性の一つになる。

## <Q w="row-echelon-form" k d />

<Q w="row-echelon-form" />とは、以下の条件をすべて満たす<Q w="mat"/>のこと。

<Graph
  w="is-row-ech-mat"
  init={[[4,3,2,0,2],[0,0,1,2,1],[0,0,0,1,0],[0,0,0,0,0]]}
>
  <><Q w="leading-entry"/>が右肩下がりである。</>
  <>$0$だけの<Q w="row"/>より、そうでない<Q w="row"/>がすべて上にくる</>
</Graph>

## <Q w="reduced-row-echelon-form" k d />

<Q w="reduced-row-echelon-form" />とは、以下の条件をすべて満たす<Q w="mat"/>のこと。

行標準形とも。

<Graph
  w="is-red-row-ech-mat"
  init={[[1,4,0,5,0,2],[0,0,1,0,0,2],[0,0,0,0,1,0],[0,0,0,0,0,0]]}
>
  <><Q w="row-echelon-form" />である</>
  <>すべての<Q w="leading-entry"/>は$1$</>
  <><Q w="leading-entry"/>のある<Q w="column"/>は、<Q w="leading-entry"/>以外は$0$</>
</Graph>

### <Q w="sol"/>を求めた<Q w="multi-variable" k/><Q w="system-of-lin-eq" k/>を<Q w="mat"/>で表現すると<Q w="reduced-row-echelon-form" k />

詳しい求め方は、後述する(TODO)で説明する。

```math:trans:1
\begin{cases}
   x + 2y + 3z = 4 \\
   x +  y + 2z = 3 \\
\end{cases}
-
\begin{cases}
   x + 2y + 3z = 4 \\
      -1y + 2z = -1 \\
\end{cases}
? 下の式から上の式を引く
-
\begin{cases}
   x + 2y + 3z = 4 \\
        y +(-2)z = 1 \\
\end{cases}
$ \text{下の式を両辺}-1\text{倍する}
-
\begin{cases}
   x +      7z = -2 \\
        y +(-2)z = 3 \\
\end{cases}
$ \text{上の式から下の式を}2\text{倍して引く}
```

より<Q w="sol"/>を<Q w="pmz"/>する。
$a \in \R$を<Q w="pm"/>として、$z=a$とすれば、

```math
\begin{cases}
  x=-2-7a \\
  y=3+2a \\
  z=a \\
\end{cases}
```

となる。

ここで、最後の式変形後の<Q w="equation"/>を<Q w="mat"/>で表現すると、

```math
\begin{pmatrix}
 1 & 0 & 7 \\
 0 & 1 &-2 \\
\end{pmatrix}
\begin{pmatrix}
 x \\ y \\ z \\
\end{pmatrix}
=
\begin{pmatrix}
 -2 \\ 3 \\
\end{pmatrix}
```

ここで左辺の<Q w="mat"/>を見ると、これは<Q w="reduced-row-echelon-form"/>だ。

## <Q w="el-row-op" k d />

ここで、上記のような<Q w="multi-variable"/>一次<Q w="system-of-lin-eq"/>に対して行えた操作をまとめて<Q w="el-row-op" />と呼ぶ。

<Q w="el-row-op" />とは、以下の3つの<Q w="mat"/>に対する操作である。

### 1. <Q w="row"/>$i$と<Q w="row"/>$j$を入れ替える。

例えば、$\ci{i=2}$, $\cj{j=3}$を選択して、

```math
\begin{pmatrix}
11 & 12 & 13 & 14 \\
\ci{21}&\ci{22}&\ci{23}&\ci{24}\\
\cj{31}&\cj{32}&\cj{33}&\cj{34}\\
41 & 42 & 43 & 44 \\
\end{pmatrix}
\rightarrow
\begin{pmatrix}
11 & 12 & 13 & 14 \\
\cj{31}&\cj{32}&\cj{33}&\cj{34}\\
\ci{21}&\ci{22}&\ci{23}&\ci{24}\\
41 & 42 & 43 & 44 \\
\end{pmatrix}
```

これは一般に、<Q w="mat"/>$\underset{n \times m}{A}$に対して、以下の<Q w="mat"/>を左から掛けることと同義である。

```math
  \begin{array}{rcl}
      \underset{n \times n}{P_{\i,\j}}
      \defeq
    &
      \hspace{-1em}
      \begin{pmatrix}
            1 &        &        &        &        &        &        &        &        &        &        \\
              & \ddots &        &        &        &        &        &        &        &        &        \\
              &        &      1 &        &        &        &        &        &        &        &        \\
              &        &        &      0 &    \ih &    \ih &    \ih &      1 &    \ih &    \ih &    \ih \\
              &        &        &    \iv &      1 &        &        &    \jv &        &        &        \\
              &        &        &    \iv &        & \ddots &        &    \jv &        &        &        \\
              &        &        &    \iv &        &        &      1 &    \jv &        &        &        \\
              &        &        &      1 &    \jh &    \jh &    \jh &      0 &    \jh &    \jh &    \jh \\
              &        &        &    \iv &        &        &        &    \jv &      1 &        &        \\
              &        &        &    \iv &        &        &        &    \jv &        & \ddots &        \\
              &        &        &    \iv &        &        &        &    \jv &        &        &      1 \\
      \end{pmatrix}
    &
      \hspace{-1em}
      \begin{matrix}
        \\
        \\
        \\
        \leftarrow \i\\
        \\
        \\
        \\
        \leftarrow \j\\
        \\
        \\
        \\
      \end{matrix}
    \\
    &
      \hspace{-1em}
      \begin{matrix}
        \quad&
        \quad&
        \quad&
        \uparrow&&
        \quad&
        \hspace{0.3em}&
        \quad&
        \uparrow&&
        \quad&
        \quad&
        \quad\\
      \end{matrix}
    &
    \\
    &
      \hspace{-1em}
      \begin{matrix}
        \quad&
        \quad&
        \quad&
        \i&&
        \quad&
        \hspace{0.3em}&
        \quad&
        \j&&
        \quad&
        \quad&
        \quad\\
      \end{matrix}
    &
    \\
  \end{array}
```

### 2. <Q w="row"/>$i$を$\lambda$倍する。($\lambda \in \R, \lambda \neq 0$)

例えば、$\ci{i=2}$, $\lambda=10$を選択して、

```math
\begin{pmatrix}
11 & 12 & 13 & 14 \\
\ci{21}&\ci{22}&\ci{23}&\ci{24}\\
31 & 32 & 33 & 34 \\
41 & 42 & 43 & 44 \\
\end{pmatrix}
\rightarrow
\begin{pmatrix}
11 & 12 & 13 & 14 \\
\ci{210}&\ci{220}&\ci{230}&\ci{240}\\
31 & 32 & 33 & 34 \\
41 & 42 & 43 & 44 \\
\end{pmatrix}
```

これは一般に、$\underset{n \times m}{A}$に対して、以下の<Q w="mat"/>を左から掛けることと同義である。

```math
  \begin{array}{rcl}
      \underset{n \times n}{P_{\i}(\lambda)}
      \defeq
    &
      \hspace{-1em}
      \begin{pmatrix}
            1 &        &        &        &        &        &        \\
              & \ddots &        &        &        &        &        \\
              &        &      1 &        &        &        &        \\
              &        &        &\lambda &    \ih &    \ih &    \ih \\
              &        &        &    \iv &      1 &        &        \\
              &        &        &    \iv &        & \ddots &        \\
              &        &        &    \iv &        &        &      1 \\
      \end{pmatrix}
    &
      \hspace{-1em}
      \begin{matrix}
        \\
        \\
        \\
        \leftarrow \i\\
        \\
        \\
        \\
      \end{matrix}
    \\
    &
      \hspace{-1em}
      \begin{matrix}
        \quad&
        \quad&
        \quad&
        \uparrow&&
        \quad&
        \quad&
        \quad\\
      \end{matrix}
    &
    \\
    &
      \hspace{-1em}
      \begin{matrix}
        \quad&
        \quad&
        \quad&
        \i&&
        \quad&
        \quad&
        \quad\\
      \end{matrix}
    &
    \\
  \end{array}
```

### 3. <Q w="row"/>$i$に<Q w="row"/>$j$を$\lambda$倍したものを加える。($\lambda \in \R, \lambda \neq 0$)

例えば、$\ci{i=3}$, $\cj{j=2}$, $\lambda=100$を選択して、

```math
\begin{pmatrix}
11 & 12 & 13 & 14 \\
\ci{21}&\ci{22}&\ci{23}&\ci{24}\\
\cj{31}&\cj{32}&\cj{33}&\cj{34}\\
41 & 42 & 43 & 44 \\
\end{pmatrix}
\rightarrow
\begin{pmatrix}
11 & 12 & 13 & 14 \\
\ci{21}&\ci{22}&\ci{23}&\ci{24}\\
\cj{2131}&\cj{2232}&\cj{2333}&\cj{2434}\\
41 & 42 & 43 & 44 \\
\end{pmatrix}
```

これは一般に、<Q w="mat"/>$\underset{n \times m}{A}$に対して、以下の<Q w="mat"/>を左から掛けることと同義である。

```math
  \begin{array}{rcl}
      \underset{n \times n}{P_{\i, \j}(\lambda)}
      \defeq
    &
      \hspace{-1em}
      \begin{pmatrix}
            1 &        &        &        &        &        &        \\
              & \ddots &        &        &\lambda &    \ih &    \ih \\
              &        &      1 &        &    \jv &        &        \\
              &        &        &      1 &    \jv &        &        \\
              &        &        &        &      1 &        &        \\
              &        &        &        &    \jv & \ddots &        \\
              &        &        &        &    \jv &        &      1 \\
      \end{pmatrix}
    &
      \hspace{-1em}
      \begin{matrix}
        \\
        \leftarrow \i\\
        \\
        \\
        \\
        \\
        \\
      \end{matrix}
    \\
    &
      \hspace{-1em}
      \begin{matrix}
        \quad&
        \quad&
        \hspace{0.5em}&
        \quad&
        \uparrow&&
        \quad&
        \quad\\
      \end{matrix}
    &
    \\
    &
      \hspace{-1em}
      \begin{matrix}
        \quad&
        \quad&
        \hspace{0.5em}&
        \quad&
        \j&&
        \quad&
        \quad\\
      \end{matrix}
    &
    \\
  \end{array}
```

## <Q w="el-mat" k d/>

<Q w="el-mat" />とは、上記で定義した$P_{i,j}$と$P_{i}(\lambda)$、そして$P_{i,j}(\lambda)$のこと。
**行**基本行列と呼ばないのは、仮に列基本行列を同様に定義したとしてもまったく同様の<Q w="mat"/>になるからだ。

## 系: <Q w="system-of-lin-eq" />を解くことは、<Q w="mat"/>を<Q w="el-row-op"/>を任意の回数行って<Q w="reduced-row-echelon-form"/>に変形することである

<Q w="system-of-lin-eq" />の<Q w="mat"/>での表現を行うと、各<Q w="column"/>がそれぞれ一つの<Q w="variable"/>$x_j$に対応することになる。ここで、<Q w="leading-entry"/>の存在しない<Q w="column"/>を<Q w="pm"/>とすれば<Q w="sol"/>が求まる。


## <Q w="el-mat" k d/>の<Q w="inv-mat" k d/>

<Q w="el-mat"/>$P$に対して、$P^{-1}$が次のように存在する。

```math
P_{i}(\lambda)^{-1} \defeq P_{i}(\lambda ^{-1}) \\
P_{i,j}^{-1} \defeq P_{i,j} \\
P_{i,j}(\lambda)^{-1} \defeq P_{i, j} (- \lambda)
```

これらはすべて、<Q w="el-row-op"/>をもとに戻す<Q w="el-row-op"/>に対応する。そのことから、以下のような性質を持つことがすぐにわかる。

- $PP^{-1} = I$
- $P^{-1}P = I$
- $(P^{-1})^{-1} = P$

## <Q w="el-row-op" />による<Q w="eq-relation" k/>の定義

<Q w="mat"/>$A$に<Q w="el-row-op" />を何回か行って$B$が得られるとき、$A\sim B$という<Q w="relation2"/>を定義すると、これは<Q w="eq-relation"/>になる。

言い換えると、<Q w="el-mat" />の<Q w="seq"/>$(P_0, P_1, \cdots, P_{n-1})$であって、$B=P_0 P_1 \cdots P_{n-1}A$であるものが存在するとき、かつそのときに限り$A \sim B$であると定義する。

<Prove>
a. <Q w="reflexivity"/>: $A \sim A$

<Q w="null-seq"/>が対応する。$A=A$であるため、$A \sim A$

b. <Q w="symmetricity"/>: $A \sim B \iff B \sim A$
  $A$から$B$にする際の<Q w="el-row-op" />の<Q w="seq"/>を、<Q w="reverse"/>させてから、各操作を逆操作(<Q w="el-mat" k d/>の<Q w="inv-mat" k d/>)に換えると、$B$から$A$への<Q w="el-row-op" />の<Q w="seq"/>になる。
    jaRuby: 'すうじく',

  <Q w="el-mat"/>で言い換えると、

  - $B=P_0 P_1 \cdots P_{p-1} A$

  としたとき、

  - $A=P_{p-1}^{-1} \cdots P_1^{-1} P_0^{-1} B$

  なので、$B \sim A$となる。

c. <Q w="transitivity"/>: $A \sim B \wedge B \sim C \Longrightarrow A \sim C$
  $A$から$B$、$B$から$C$への操作列をそのまま連結すると$A$から$C$への操作<Q w="seq"/>になる。

  <Q w="el-mat"/>で言い換えると、

  - $B=P_0 P_1 \cdots P_{p-1} A$
  - $C=Q_0 Q_1 \cdots Q_{q-1} B$

  としたとき、

  ```math:trans
  C
  =
    Q_0 Q_1 \cdots Q_{q-1} (P_0 P_1 \cdots P_{p-1} A)
  =
    (Q_0 Q_1 \cdots Q_{q-1} P_0 P_1 \cdots P_{p-1}) A
  ?
     \load{qk:mat-mult}の\load{qk:associativity}
  ```

  $(Q_0, Q_1, \cdots, Q_{q-1}, P_0, P_1, \cdots, P_{p-1})$ は<Q w="el-mat"/>の<Q w="seq"/>であるから、$A \sim C$
</Prove>

## <Q w="matrix-elimination"k d/>

<Q w="matrix-elimination"/>とは、<Q w="mat"/>を<Q w="el-row-op" />によって<Q w="reduced-row-echelon-form"/>に変形することだ。もう少し形式的に言うなら、与えられた<Q w="mat"/>$A$に対して、$B = P_0 P_1 \cdots P_{p-1} A$であるような<Q w="el-mat"/>の<Q w="seq"/>$P$と<Q w="reduced-row-echelon-form"/>$B$の<Q w="tuple"/>を提示すること、ということ。

「$A$を<Q w="matrix-elimination"/>する」というのを、「<Q w="el-mat"/>の<Q w="seq"/>$P_0, P_1, \cdots P_{p-1}$であって、$P \coloneqq P_0 P_1 \cdots P_{p-1}$と定義して、$PA=X$なるものを選ぶ」を意味するものとする。<Q w="variable"/>$P, p$は$Q, q$であったりする場合もある。また、$P_{p-1}^{-1} \cdots P_1 P_0\cdots$を考えると、これは$P^{-1}$である。

$P_i^{-1}$は[TODO](TODO)より常に存在する。

また、同様の用語として、<Q w="upper-triangular-matrix"/>を目指すことを<Q w="mat-make-upper-tri"d/>と呼ぶことにする。

## <Q w="gauss-elim" k d/>

<Q w="gauss-elim"/>は、任意の<Q w="mat"/>を<Q w="matrix-elimination"/>する<Q w="algo"/>だ。

<Q w="forward-elim"/>と<Q w="back-subst"/>の2つのパートからなる。

ここではそれぞれの概要を説明する。厳密なアルゴリズムに関しては、以下のアニメーションを、数値を変えながら試してほしい。

{/* TODO: ( るまライブラリ(実装部門)の生まれ変わりの準備ができたらそちらへのリンクを貼る予定。) */}

<Graph w="gauss-elim" init={[[1,2,2,4],[2,3,1,5],[2,0,-5,8]]}/>

### <Q w="forward-elim" k d/>

<Q w="forward-elim"/>では、<Q w="upper-triangular-matrix"/>かつ、主成分が$1$であることを目指す。同時に、<Q w="pivotting"/>という、見ている<Q w="elem"/>が$0$であった場合に別の<Q w="row"/>と交換する ($P_{i,j}$に対応する) をすることによって、<Q w="zero"/><Q w="row"/>が自動的に下に行く。

<Q w="forward-elim"/>の終了時点で得られた<Q w="leading-entry"/>は、最終的に得られる<Q w="reduced-row-echelon-form"/>の<Q w="leading-entry"/>となる。

### <Q w="back-subst" k d/>

<Q w="back-subst"/>では、<Q w="forward-elim"/>で決定した<Q w="leading-entry"/>をすべてを、上向きに探索する。そして、それぞれについて、<Q w="forward-elim"/>と同じように、打ち消すように $P_{i, j}(\lambda)$を行う。やっていることはほぼ同じである。

### <Q w="back-subst" k/>を行う理由について

<Q w="back-subst"/>を行う理由、もしくは、<Q w="forward-elim"/>と<Q w="upper-triangular-matrix"/>を分ける理由について。単に<Q w="reduced-row-echelon-form"/>を得るだけなら、<Q w="forward-elim"/>の時点で、後ろ向きにも削除を行えば、<Q w="algo"/>はシンプルになる。<Q w="gauss-jordan-elim" d/>は、そのような実装のバリエーションを指すことがある。

しかし、わざわざ<Q w="back-subst"/>として分けるのは、計算回数を抑えるためだ。実際、アニメーションを見てもらうと、<Q w="back-subst"/>の際には、これまで調べた<Q w="leading-entry"/>に関しては$0$だとわかっているので、処理をしなくてすむ。

### <Q w="gauss-elim" k/>の<Q w="comp-comp"k/><diff/>

加算・乗算の回数がどれくらい起こるか、という<Q w="comp-comp"/>を考える。$n \times m$の<Q w="mat"/>に対して<Q w="gauss-elim"/>を行うとする。それぞれの$n, m$について最悪でどれくらいになるかを考える。
これは最悪$\Theta(\min\{n, m\} n m) = \Theta((n + m)nm)$になる。

### 例

```math
A=
\begin{pmatrix}
       1 &     2 &     2 &     4 \\
       2 &     3 &     1 &     5 \\
       2 &     0 &    -5 &     8 \\
\end{pmatrix}
```

上記の<Q w="mat"/>に対して<Q w="gauss-elim"/>を行う、以下の例を見る。

```math:trans:1
\begin{pmatrix}
       1 &     2 &     2 &     4 \\
       2 &     3 &     1 &     5 \\
       2 &     0 &    -5 &     8 \\
\end{pmatrix}
~
\begin{pmatrix}
  \ci{ 1}&\ci{ 2}&\ci{ 2}&\ci{ 4}\\
  \cj{ 0}&\cj{-1}&\cj{-3}&\cj{-3}\\
       2 &     0 &    -5 &     8 \\
\end{pmatrix}
$ P_{\ci{1},\cj{2}}(-2)
~
\begin{pmatrix}
  \ci{ 1}&\ci{ 2}&\ci{ 2}&\ci{ 4}\\
       0 &    -1 &    -3 &    -3 \\
  \cj{ 0}&\cj{-4}&\cj{-9}&\cj{ 0}\\
\end{pmatrix}
$ P_{\ci{1},\cj{3}}(-2)
~
\begin{pmatrix}
       1 &     2 &     2 &     4 \\
       0 &\ci{ 1}&\ci{ 3}&\ci{ 3}\\
       0 &    -4 &    -9 &     0 \\
\end{pmatrix}
$ P_{\ci{2}}(-1)
~
\begin{pmatrix}
       1 &     2 &     2 &     4 \\
       0 &\ci{ 1}&\ci{ 3}&\ci{ 3}\\
       0 &\cj{ 0}&\cj{ 3}&\cj{12}\\
\end{pmatrix}
$ P_{\ci{2},\cj{3}}(4)
~
\begin{pmatrix}
       1 &     2 &     2 &     4 \\
       0 &     1 &     3 &     3 \\
       0 &     0 &\ci{ 1}&\ci{ 4}\\
\end{pmatrix}
$ P_{\ci{3}}\left(\frac{1}{3}\right)
~
\begin{pmatrix}
       1 &     2 &\cj{ 0}&\cj{-4}\\
       0 &     1 &     3 &     3 \\
       0 &     0 &\ci{ 1}&\ci{ 4}\\
\end{pmatrix}
$ P_{\ci{3},\cj{1}}(-2)
~
\begin{pmatrix}
       1 &     2 &     0 &    -4 \\
       0 &     1 &\cj{ 0}&\cj{-9}\\
       0 &     0 &\ci{ 1}&\ci{ 4}\\
\end{pmatrix}
$ P_{\ci{3},\cj{2}}(-3)
~
\begin{pmatrix}
       1 &\cj{ 0}&     0 &\cj{14}\\
       0 &\ci{ 1}&     0 &\ci{-9}\\
       0 &     0 &     1 &     4 \\
\end{pmatrix}
$ P_{\ci{2},\cj{1}}(-2)
```

以上より、


```math
P_{2,1}(-2)
P_{3,2}(-3)
P_{3,1}(-2)
P_{3}\left(\frac{1}{3}\right)
P_{2,3}(4)
P_{2}(-1)
P_{1,3}(-2)
P_{1,2}(-2)
A
=
\begin{pmatrix}
       1 &     0 &     0 &    14 \\
       0 &     1 &     0 &    -9 \\
       0 &     0 &     1 &     4 \\
\end{pmatrix}
```

左辺の<Q w="el-mat"/>の<Q w="seq"/>の<Q w="mat-mult"/>を計算すると、

```math
\left(\begin{matrix}5 & - \frac{10}{3} & \frac{4}{3}\\-4 & 3 & -1\\2 & - \frac{4}{3} & \frac{1}{3}\end{matrix}\right)
```

## 定理: 任意の<Q w="mat"/>は、<Q w="el-row-op" />によって<Q w="reduced-row-echelon-form"/>に変形することが可能。

<Q w="gauss-elim"/>がそのまま構築による証明となる。

## <Q w="gauss-jordan-elim" k d />

<Q w="gauss-elim"/>の中でも少しだけ触れたが、<Q w="gauss-jordan-elim"/>の定義はいくつかの文献でゆらぎがある。ただ、かんたんにまとめると、<Q w="gauss-jordan-elim"/>は<Q w="gauss-elim"/>のアルゴリズムの方針を利用して、<Q w="el-row-op"/>や<Q w="el-column-op"/>によって<Q w="reduced-row-echelon-form"/>や<Q w="upper-triangular-matrix"/>に変形すること、もしくはそのアイデアのことを指す。

そのアイデアというのはつまり、左上から順に<Q w="leading-entry"/>を決定していくことである。

## 定理: 任意の<Q w="mat"/>について、<Q w="el-row-op" />によって得られる<Q w="reduced-row-echelon-form"/>は一意である。

この定理に明確に言及しているのを見かける機会は少ないかもしれないが、今後の各種定義が<Q w="well-def"/>であるかどうかはこの定理による部分が多い。

<Prove>

<Q w="mat"/>$A$が異なる<Q w="el-mat"/>の<Q w="seq"/>によって<Q w="matrix-elimination"/>されたとする。

- $P_0 P_1 \cdots P_{p-1} A=K$
- $Q_0 Q_1 \cdots Q_{q-1} A=K^\prime$

ということになる。$K=K^\prime$を示せばよい。

まず、

- $A=P_{p-1}^{-1} \cdots P_1^{-1} P_0^{-1} K$
- $A=Q_{q-1}^{-1} \cdots Q_1^{-1} Q_0^{-1} K^\prime$

と変形できる。つまり、$P_{p-1}^{-1} \cdots P_1^{-1} P_0^{-1}K=Q_{q-1}^{-1} \cdots Q_1^{-1} Q_0^{-1} K^\prime$となるが、更に変形して、

```math
K=P_0 P_1 \cdots P_{p-1} Q_{q-1}^{-1} \cdots Q_1^{-1} Q_0^{-1} K^\prime
```

となる。$F = P_0 P_1 \cdots P_{p-1} Q_{q-1}^{-1} \cdots Q_1^{-1} Q_0^{-1}$と置く。$K=FK^\prime$

$F (Q_0 Q_1 \cdots Q_{q-1} P_{p-1}^{-1} \cdots P_1^{-1} P_0^{-1}) = I$であるから、$F$は<Q w="invertible-mat"/>だ。つまり、<Q w="zero"/><Q w="row"/>がない。この性質をこのあと用いる。

さて、ここからは、[TODO](#q-mat-mult-の計算方法)と同様の表記法をして、$K^\prime$のみから$F$と$K$が決定できることを示す。

$K^\prime=FK$の掛け算を以下のように表す。

```math
\begin{matrix}
  &
    K^\prime
  \\
    F
  &
    K
\end{matrix}
```

決定されていない場所を$?$、任意の値がありうる場所を$*$で表記したのが以下だ。

```math
\begin{matrix}
  &
    \begin{pmatrix}
      0 & 1 & * & 0 & * & 0 & * \\
      0 & 0 & 0 & 1 & * & 0 & * \\
      0 & 0 & 0 & 0 & 0 & 1 & * \\
      0 & 0 & 0 & 0 & 0 & 0 & 0 \\
    \end{pmatrix}
    =K^\prime
  \\
    F=
    \begin{pmatrix}
      ? & ? & ? & ? \\
      ? & ? & ? & ? \\
      ? & ? & ? & ? \\
      ? & ? & ? & ? \\
    \end{pmatrix}
  &
    \begin{pmatrix}
      ? & ? & ? & ? & ? & ? & ? \\
      ? & ? & ? & ? & ? & ? & ? \\
      ? & ? & ? & ? & ? & ? & ? \\
      ? & ? & ? & ? & ? & ? & ? \\
    \end{pmatrix}
    =K
\end{matrix}
```

$3$個の<Q w="leading-entry"/>である場合を例示している。なお、$K^\prime$の左側と下側の<Q w="zero"/><Q w="row"/>・<Q w="column"/>は$0$個以上の任意の数がそれぞれあり得る。また、$*$（アスタリスク）のある<Q w="column"/>も同様に$0$個以上の任意の数だ。

$K$を左の<Q w="column"/>から決定していく。

### 1ブロック目 (最初に0列以上続く<Q w="zero"/><Q w="column"/>)

まずは<Q w="zero"/><Q w="column"/>なので、$K$の1列目も$0$のみである。$F$については何も決定しない。

```math
\begin{matrix}
  &
    \begin{pmatrix}
      \ci{0} & 1 & * & 0 & * & 0 & * \\
      \ci{0}& 0 & 0 & 1 & * & 0 & * \\
      \ci{0}& 0 & 0 & 0 & 0 & 1 & * \\
      \ci{0}& 0 & 0 & 0 & 0 & 0 & 0 \\
    \end{pmatrix}
    =K^\prime
  \\
    F=
    \begin{pmatrix}
      ? & ? & ? & ? \\
      ? & ? & ? & ? \\
      ? & ? & ? & ? \\
      ? & ? & ? & ? \\
    \end{pmatrix}
  &
    \begin{pmatrix}
      \ci{0}& ? & ? & ? & ? & ? & ? \\
      \ci{0}& ? & ? & ? & ? & ? & ? \\
      \ci{0}& ? & ? & ? & ? & ? & ? \\
      \ci{0}& ? & ? & ? & ? & ? & ? \\
    \end{pmatrix}
    =K
\end{matrix}
```

### 2ブロック目 (最初の<Q w="leading-entry"/>を含む列)

```math
\begin{matrix}
  &
    \begin{pmatrix}
      0&\ci{1}& * & 0 & * & 0 & * \\
      0&    0 & 0 & 1 & * & 0 & * \\
      0&    0 & 0 & 0 & 0 & 1 & * \\
      0&    0 & 0 & 0 & 0 & 0 & 0 \\
    \end{pmatrix}
    =K^\prime
  \\
    F=
    \begin{pmatrix}
      ? & ? & ? & ? \\
      ? & ? & ? & ? \\
      ? & ? & ? & ? \\
      ? & ? & ? & ? \\
    \end{pmatrix}
  &
    \begin{pmatrix}
      0&\ci{!}& ? & ? & ? & ? & ? \\
      0& ? & ? & ? & ? & ? & ? \\
      0& ? & ? & ? & ? & ? & ? \\
      0& ? & ? & ? & ? & ? & ? \\
    \end{pmatrix}
    =K
\end{matrix}
```

$\ci{!}$で表した<Q w="elem"/>について、この値は$1$のみがありうる。
まず、$0$だとしたら、$F$の1行目がすべて$0$となってしまう。
そして、<Q w="reduced-row-echelon-form"/>の条件より$1$と決定できる。<Q w="reduced-row-echelon-form"/>であるため、その下も$0$だと決定できる。

---

```math
\begin{matrix}
  &
    \begin{pmatrix}
      0&\cj{1}& * & 0 & * & 0 & * \\
      0&    0 & 0 & 1 & * & 0 & * \\
      0&    0 & 0 & 0 & 0 & 1 & * \\
      0&    0 & 0 & 0 & 0 & 0 & 0 \\
    \end{pmatrix}
    =K^\prime
  \\
    F=
    \begin{pmatrix}
      \ci{!}& ? & ? & ? \\
      ? & ? & ? & ? \\
      ? & ? & ? & ? \\
      ? & ? & ? & ? \\
    \end{pmatrix}
  &
    \begin{pmatrix}
      0&\ck{1}& ? & ? & ? & ? & ? \\
      0&\ci{0}& ? & ? & ? & ? & ? \\
      0&\ci{0}& ? & ? & ? & ? & ? \\
      0&\ci{0}& ? & ? & ? & ? & ? \\
    \end{pmatrix}
    =K
\end{matrix}
```

$\ci{!}$で表した$F$の<Q w="elem"/>について、$\cj{1} \times \ci{!} + 0 \times ? + 0 \times ? + 0 \times ? = \ck{1}$を満たす必要がある。
よって、この値は$1$のみがありうる。

---

```math
\begin{matrix}
  &
    \begin{pmatrix}
      0&\cj{1}& * & 0 & * & 0 & * \\
      0&    0 & 0 & 1 & * & 0 & * \\
      0&    0 & 0 & 0 & 0 & 1 & * \\
      0&    0 & 0 & 0 & 0 & 0 & 0 \\
    \end{pmatrix}
    =K^\prime
  \\
    F=
    \begin{pmatrix}
      \ci{1}& ? & ? & ? \\
      \ci{!}& ? & ? & ? \\
      \ci{!}& ? & ? & ? \\
      \ci{!}& ? & ? & ? \\
    \end{pmatrix}
  &
    \begin{pmatrix}
      0&\ci{1}& ? & ? & ? & ? & ? \\
      0&\ck{0}& ? & ? & ? & ? & ? \\
      0&\ck{0}& ? & ? & ? & ? & ? \\
      0&\ck{0}& ? & ? & ? & ? & ? \\
    \end{pmatrix}
    =K
\end{matrix}
```

$\ci{!}$で表した$F$のすべての<Q w="elem"/>について、$\cj{1} \times \ci{!} + 0 \times ? + 0 \times ? + 0 \times ? = \ck{0}$を満たす必要がある。
よって、この値は$0$のみがありうる。

---

```math
\begin{matrix}
  &
    \begin{pmatrix}
      0&1& * & 0 & * & 0 & * \\
      0&0& 0 & 1 & * & 0 & * \\
      0&0& 0 & 0 & 0 & 1 & * \\
      0&0& 0 & 0 & 0 & 0 & 0 \\
    \end{pmatrix}
    =K^\prime
  \\
    F=
    \begin{pmatrix}
      \ci{1}& ? & ? & ? \\
      \ci{0}& ? & ? & ? \\
      \ci{0}& ? & ? & ? \\
      \ci{0}& ? & ? & ? \\
    \end{pmatrix}
  &
    \begin{pmatrix}
      0&1& ? & ? & ? & ? & ? \\
      0&0& ? & ? & ? & ? & ? \\
      0&0& ? & ? & ? & ? & ? \\
      0&0& ? & ? & ? & ? & ? \\
    \end{pmatrix}
    =K
\end{matrix}
```

### 3ブロック目 (0列以上続く、1行目まで任意の値を含む列)

このブロックは、一般化すると、1ブロック目と同一だと捉えらる。

```math
\begin{matrix}
  &
    \begin{pmatrix}
      0&1&\ci{*}& 0 & * & 0 & * \\
      0&0&\ci{0}& 1 & * & 0 & * \\
      0&0&\ci{0}& 0 & 0 & 1 & * \\
      0&0&\ci{0}& 0 & 0 & 0 & 0 \\
    \end{pmatrix}
    =K^\prime
  \\
    F=
    \begin{pmatrix}
      \ci{1}& ? & ? & ? \\
      \ci{0}& ? & ? & ? \\
      \ci{0}& ? & ? & ? \\
      \ci{0}& ? & ? & ? \\
    \end{pmatrix}
  &
    \begin{pmatrix}
      0&1&\ci{*}& ? & ? & ? & ? \\
      0&0&\ci{0}& ? & ? & ? & ? \\
      0&0&\ci{0}& ? & ? & ? & ? \\
      0&0&\ci{0}& ? & ? & ? & ? \\
    \end{pmatrix}
    =K
\end{matrix}
```

$F$の1列目が決定しているため、$K^\prime$と同一の<Q w="column"/>であると決定する。
$K$側の$*$は、$K^\prime$と同様の値であるとする。

### 4ブロック目 (2個目の<Q w="leading-entry"/>を含む列)

このブロックは、一般化すると、2ブロック目と同一だと捉えらる。

```math
\begin{matrix}
  &
    \begin{pmatrix}
      0&1&*&\ci{0}& * & 0 & * \\
      0&0&0&\ci{1}& * & 0 & * \\
      0&0&0&\ci{0}& 0 & 1 & * \\
      0&0&0&\ci{0}& 0 & 0 & 0 \\
    \end{pmatrix}
    =K^\prime
  \\
    F=
    \begin{pmatrix}
      1&?& ? & ? \\
      0&?& ? & ? \\
      0&?& ? & ? \\
      0&?& ? & ? \\
    \end{pmatrix}
  &
    \begin{pmatrix}
      0&1&*&\ci{0}& ? & ? & ? \\
      0&0&0&\ci{1}& ? & ? & ? \\
      0&0&0&\ci{0}& ? & ? & ? \\
      0&0&0&\ci{0}& ? & ? & ? \\
    \end{pmatrix}
    =K
\end{matrix}
```

2ブロック目と同様に、$F$の2行目がすべて$0$になってはいけないこと、<Q w="mat-mult"/>による等式から$1$であることが決定し、<Q w="reduced-row-echelon-form"/>であることから、他の<Q w="elem"/>が$0$であることが決定する。

---

```math
\begin{matrix}
  &
    \begin{pmatrix}
      0&1&*&\ci{0}& * & 0 & * \\
      0&0&0&\ci{1}& * & 0 & * \\
      0&0&0&\ci{0}& 0 & 1 & * \\
      0&0&0&\ci{0}& 0 & 0 & 0 \\
    \end{pmatrix}
    =K^\prime
  \\
    F=
    \begin{pmatrix}
      1&\ci{0}& ? & ? \\
      0&\ci{1}& ? & ? \\
      0&\ci{0}& ? & ? \\
      0&\ci{0}& ? & ? \\
    \end{pmatrix}
  &
    \begin{pmatrix}
      0&1&*&0& ? & ? & ? \\
      0&0&0&1& ? & ? & ? \\
      0&0&0&0& ? & ? & ? \\
      0&0&0&0& ? & ? & ? \\
    \end{pmatrix}
    =K
\end{matrix}
```

$F$についても、同様に2行目とそれ以外でそれぞれ立式すると、$1$と$0$に決定する。

### 終了時

のこりは同様に、ということになる。

```math
\begin{matrix}
  &
    \begin{pmatrix}
      0&1&*&0& * & 0 & * \\
      0&0&0&1& * & 0 & * \\
      0&0&0&0& 0 & 1 & * \\
      0&0&0&0& 0 & 0 & 0 \\
    \end{pmatrix}
    =K^\prime
  \\
    F=
    \begin{pmatrix}
      1&0&0& ? \\
      0&1&0& ? \\
      0&0&1& ? \\
      0&0&0& ? \\
    \end{pmatrix}
  &
    \begin{pmatrix}
      0&1&*&0& * & 0 & * \\
      0&0&0&1& * & 0 & * \\
      0&0&0&0& 0 & 1 & * \\
      0&0&0&0& 0 & 0 & 0 \\
    \end{pmatrix}
    =K
\end{matrix}
```

これにより、$F=F^\prime$が示された。

</Prove>

上記は具体的なものしか取り扱っていないが、形式的な議論が見える範囲で記述するように心がけた。

なお、$F$は上記のように決定しないこともある。行数より<Q w="leading-entry"/>が少ない場合がそうだ。これは、下の<Q w="zero"/><Q w="row"/>に関して<Q w="el-row-op"/>を追加でいくらやっても良い、その自由度から来ている。なお、この決定されない行数はそのまま<Q w="dof"/>の定義として使える。

## 定理: <Q w="invertible-mat"/>ならば<Q w="square-matrix"/>である。

<Prove>
```math
\underset{n \times m}{A}
\cdot
\underset{m \times n}{B}
=
I_n

\\

\underset{m \times n}{B}
\cdot
\underset{n \times m}{A}
=
I_m
```

としておく。

$A$を<Q w="matrix-elimination"/>して$\underset{n \times n}{P}\cdot\underset{n \times m}{A}=\underset{n \times m}{X}$、両辺に右から$B$を乗じて$PAB=XB$、$PAB=P(AB)=PI=P$より、$P=XB$となる。
$PP^{-1}=I$であるので、$P$は<Q w="zero"/><Q w="row"/>を含まない。
ここで、もし$X$が<Q w="zero"/><Q w="row"/>を含むと、$P$も<Q w="zero"/><Q w="row"/>を持つことになるが、上記に矛盾するので、$X$は<Q w="zero"/><Q w="row"/>を含まない。
<Q w="zero"/><Q w="row"/>を含まない<Q w="reduced-row-echelon-form"/>は<Q w="main-diag"/>が$1$で、それ以外が$0$のもので、$\underset{n \times m}{X}$は横長か<Q w="square-matrix"/>($n \leq m$)である。

また、$B$を<Q w="matrix-elimination"/>して$\underset{m \times m}{Q}\cdot\underset{m \times n}{B}=\underset{m \times n}{Y}$とする。
$QB=Y$、両辺に右から$A$を乗じて$Q=YA$となる。$Q$も同様の議論で<Q w="zero"/><Q w="row"/>を含まないので、$\underset{m \times n}{Y}$も含まない。よって、$Y$は横長か<Q w="square-matrix"/>($m \leq n$)である。

よって$n = m$。
</Prove>

## 系: <Q w="invertible-mat"k/>を<Q w="el-mat"k/>すると<Q w="identity-matrix"k/>となる。

<Q w="square-matrix"/>かつ<Q w="reduced-row-echelon-form"/>であって、<Q w="zero"/><Q w="row"/>を含まないものは<Q w="identity-matrix"/>のみであるから。

## 系: 任意の<Q w="invertible-mat"k/>は<Q w="el-mat"k/>の<Q w="mat-mult"/>で表わせる。

$A$を<Q w="invertible-mat"/>とする。

<Prove>
$BA=I$なる$B$が存在する。$B$を<Q w="matrix-elimination"/>して$PB=I$となる。両辺に右から$A$をかけると、$P(BA)=A$、よって$P=A$。$A=P_0 P_1 \cdots P_{p-1}$となる。
</Prove>

## <Q w="mat" />と<Q w="real" k />の相違

1. 一般に$AB \neq BA$。$AB=BA$なら$A$と$B$は<Q w="commutative" d />である、という。
  例えば<Q w="symmetrix-matrix"/>同士は常に<Q w="commutative" />である。
1. $A\neq O, B \neq O$であっても$AB=O$となりうる。このとき、$A$と$B$を<Q w="zero-divisor" />という。例:
  ```math
    \begin{pmatrix}
      1 & 1 \\
      2 & 2 \\
    \end{pmatrix}
    \begin{pmatrix}
      1 & 1 \\
      -1 & -1 \\
    \end{pmatrix}
    =
    \begin{pmatrix}
      0 & 0 \\
      0 & 0 \\
    \end{pmatrix}
  ```
1. $A \neq O$であっても$A^{-1}$が存在する(<Q w="invertible-mat"/>である)とは限らない。

## <Q w="mat-rank" k d/>

任意の<Q w="mat"/>$A$に関する<Q w="mat-rank" k d/>を、$A$を<Q w="matrix-elimination"/>して$PA=X$になるとして、$X$の<Q w="leading-entry"/>の数として定義する。

この定義は[TODO](#TODO)によって<Q w="well-def"/>である。($P$のとり方によらない)

<Q w="mat-rank"/>を$\rank A$と書く。

### 定理: $P$が<Q w="el-mat"k/>なら、$\rank PB = \rank B$

<Prove>
$PB$の<Q w="matrix-elimination"/>$QPB=X$を考えると、$QP$がそのまま$B$の<Q w="matrix-elimination"/>になっている。
よって、$PB$と$B$の<Q w="mat-rank"/>はどちらも$X$の<Q w="zero"/>でない<Q w="row"/>の個数として一致する。
</Prove>

### 系: $A$が<Q w="invertible-mat"/>なら、$\rank AB = \rank B$

<Prove>
[TODO](TODO)より$A=P_0 P_1 \cdots P_{p-1}$と表せるから、
$\rank AB = \rank P_0 P_1 \cdots P_{p-1} B$、[TODO](TODO)を$p$回適用して、$\rank AB = \rank B$
</Prove>

### 定理: $A \in \R^{n \times n}$について。$A$が<Q w="invertible-mat"/>$\iff \rank A = n$

<Prove>
$\Longrightarrow$は[TODO](TODO)によりすぐ。

$\Longleftarrow$について。
$\rank A = n$なので$A$を<Q w="matrix-elimination"/>すると$PA=I$となる。$P$が$A^{-1}$である。
</Prove>

## 定理: $k$個の<Q w="zero"k/><Q w="row"k/>を含む<Q w="mat"k/>$\underset{n \times m}{A}$について、$\rank A \leq n - k$

<Prove>
<Q w="gauss-elim"/>を考えると、<Q w="zero"k/><Q w="row"k/>はそのまま<Q w="matrix-elimination"/>しても残ることになる。
よって、<Q w="reduced-row-echelon-form"/>には、$k$個は少なくとも<Q w="zero"/><Q w="row"/>が含まれることになる。
</Prove>

## 定理: $A$が<Q w="invertible-mat"k/>でなければ、$AB$も<Q w="invertible-mat"k/>ではない。

今後に議論するより多くの<Q w="mat-rank"/>の性質からすぐにわかることなのだが、ここでは一応別の方法で示す。

<Prove>
$A$を<Q w="matrix-elimination"/>して$PA=X$とする。$A=P^{-1}X$となる。

```math:trans:1
  \rank AB
= \rank P^{-1}XB
? $A=P^{-1}X$を代入
= \rank XB
? TODOより
```

ここで、$A$は<Q w="invertible-mat"/>でないから、$X$は<Q w="zero"/><Q w="row"/>を含む。$XB$も同様に含む。TODOより、$\rank XB < n$。よって、$\rank AB < n$であるが、TODOより$AB$は<Q w="invertible-mat"/>ではない。
</Prove>

## <Q w="system-of-lin-eq" k d/>の求め方

<Q w="system-of-lin-eq"/>とは一次の<Q w="system-of-eq"/>のこと。$n$<Q w="variable"/>で$m$連立であるとすると、<Q w="variable"/>を$\mathbf{x}=\begin{pmatrix}x_0 & x_1 & \cdots & x_{n-1}\end{pmatrix}$として、$\underset{n \times m}A \mathbf{x}=\mathbf{b}$と書ける。

$\mathbf b = \mathbf 0$の場合、その<Q w="system-of-lin-eq"/>は<Q w="homo"/>である、という。


<Q w="system-of-lin-eq"/>を<Q w="gauss-elim"/>を使って解くことが可能。


```math:def
\def\augmat{\left(\begin{array}{c|c}A & \mathbf{b}\end{array}\right)}
\def\augmatz{\left(\begin{array}{c|c}A & \mathbf{0}\end{array}\right)}
\def\augmatx{\left(\begin{array}{c|c}A' & \mathbf{b}'\end{array}\right)}
```

まず、$\left(\begin{array}{c|c}A & \mathbf{b}\end{array}\right)$という<Q w="mat"/>を考える。これを上記の<Q w="system-of-lin-eq"/>に対する<Q w="aug-mat"/>と呼ぶ。

$\augmat$に対する<Q w="el-row-op"/>は、もとの<Q w="system-of-eq"/>への同値変形と<Q w="identify"/>できる。

そこで、$\augmat$を<Q w="gauss-elim"/>する。それを、$\augmat \sim \augmatx$とする。たとえば以下のような形をしている。

```math
\left(\begin{array}{cccc|c}
  1 & * & 0 & * & * \\
  0 & 0 & 1 & * & * \\
  0 & 0 & 0 & 0 & * \\
  0 & 0 & 0 & 0 & * \\
\end{array}\right)
```

ここで、もし最右**だけ**$0$でない<Q w="row"/>、つまり、上の例で言う最後の行のアスタリスクが$0$でない場合は、<Q w="sol"/>がない。

$\rank A < \rank \augmat$なら<Q w="sol"/>なし、ということだ。
ここから、<Q w="system-of-lin-eq"/>の<Q w="sol"/>の存在の必要十分条件は、$\rank A = \rank \augmat$であることがわかる。

逆にそうでない場合は<Q w="sol"/>が必ず存在する。

各<Q w="column"/>が一つの<Q w="variable"/>に対応している。
<Q w="leading-entry"/>がない<Q w="column"/>をそれぞれ自由変数を割り当てて、<Q w="leading-entry"/>がある<Q w="row"/>について、<Q w="leading-entry"/>以外の<Q w="term"/>を移すと一般解が得られる。

また、<Q w="homo"/><Q w="system-of-lin-eq"/>の場合は、常に<Q w="sol"/>が存在する。<Q w="homo"/>なら常に$\rank A = \rank \augmat = \rank \augmatz$であるからだ。

## <Q w="dof"k d/>

<Q w="sol"/>が存在する<Q w="system-of-lin-eq"/>$\underset{n \times m}{A} \mathbf{x} = \mathbf{b}$の<Q w="dof"/>を、これを解いた際の、一般解の自由変数の(最小)数として定義する。

イメージとしては、<Q w="dof"/>$0$なら点、$1$なら線、$2$なら平面のようになる。TODO

<Q w="dof"/>は、$A$を<Q w="matrix-elimination"/>した際の<Q w="zero"/>でない<Q w="row"/>の数、つまり$m - \rank A$と等しくなる。
