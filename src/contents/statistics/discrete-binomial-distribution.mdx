```toml
title = "二項分布"
published = true
```

## 意味

成功確率 $p$ のベルヌーイ試行を $n$ 繰り返したときの、成功回数を確率変数とする離散確率分布。

## 確率密度関数

$$
f(k; n, p) = \binom{n}{k} p^k (1-p)^{n-k}
$$

ここで $k$ は成功回数、 $n$ は試行回数、 $p$ は成功確率。

## 期待値と分散

```math
\begin{align*}
\Exp {X} &= np \\
\Var {X} &= np(1-p)
\end{align*}
```


感覚的な理解:
- $n$ 回の繰り返しのうち、割合として $p$ が成功するから、成功回数の期待値は $np$ 。
- 期待値の線形性から、 $\Exp {X} = \Exp {\sum_{i=1}^n X_i} = \sum_{i=1}^n \Exp {X_i} = \sum_{i=1}^n p = np$ 。
  - 期待 $p$ の成功への貢献が $n$ 個。
- 分散は $p=0,1$ で $0$ になる。片方の値しか出なければ散らばらない。
- 分散は $p=0.5$ のときに最大値を取り、 $n/4$ となる。満遍なく出るときが、最も散らばっている。
- $n$ が大きいほど、分散は大きくなる。試行回数が多いほど、成功回数の散らばりは大きくなる。


## モーメント母関数

```math trans1
  M_X(t)
= \Exp {e^{tX}}
= \sum_{k=0}^n e^{tk} f(k; n, p)
= \sum_{k=0}^n e^{tk} \binom{n}{k} p^k (1-p)^{n-k}
= \sum_{k=0}^n \binom{n}{k} (pe^t)^k (1-p)^{n-k}
= ((pe^t) + (1 - p))^n
? 二項定理
= (pe^t + 1 - p)^n
```

- $M'_X(t) = n(pe^t)^{n-1} e^t$
- $M''_X(t) = n(n-1)(pe^t)^{n-2} e^{2t} + n(pe^t)^{n-1} e^t$

- $\Exp {X} = M'_X(0) = np$
- $\Var {X} = M''_X(0) - (M'_X(0))^2 = np(1-p)$

## double-countingによる別証明

TODO

## 参考

- https://ja.wikipedia.org/wiki/%E4%BA%8C%E9%A0%85%E5%88%86%E5%B8%83


